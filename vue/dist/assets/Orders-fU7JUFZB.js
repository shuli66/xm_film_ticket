import{aD as $,aE as L,v as K,aF as te,y as ie,F as Y,_ as le,r as se,c as V,a as P,b as v,w as m,j as I,E as F,aG as ue,K as de,B as ce,L as fe,M as he,N as ve,O as me,o as R,h as y,t as N,i as T,z as ee,aH as ge,I as pe,ad as we,S as _e,G as Ee,af as Ce,R as ye}from"./index-DNfxLx3V.js";/* empty css               *//* empty css                *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                *//* empty css                          *//* empty css                     *//* empty css               *//* empty css              */import{r as q}from"./request-B9NmRS_H.js";import{p as Ne,o as Me}from"./api-YTng1EZn.js";/*!
 * qrcode.vue v3.6.0
 * A Vue.js component to generate QRCode. Both support Vue 2 and Vue 3
 * © 2017-PRESENT @scopewu(https://github.com/scopewu)
 * MIT License.
 */var D=function(){return D=Object.assign||function(i){for(var f,c=1,h=arguments.length;c<h;c++){f=arguments[c];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(i[p]=f[p])}return i},D.apply(this,arguments)};var U;(function(s){var i=function(){function a(e,t,r,n){if(this.version=e,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],e<a.MIN_VERSION||e>a.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=e*4+17;for(var u=[],o=0;o<this.size;o++)u.push(!1);for(var o=0;o<this.size;o++)this.modules.push(u.slice()),this.isFunction.push(u.slice());this.drawFunctionPatterns();var l=this.addEccAndInterleave(r);if(this.drawCodewords(l),n==-1)for(var w=1e9,o=0;o<8;o++){this.applyMask(o),this.drawFormatBits(o);var S=this.getPenaltyScore();S<w&&(n=o,w=S),this.applyMask(o)}h(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}return a.encodeText=function(e,t){var r=s.QrSegment.makeSegments(e);return a.encodeSegments(r,t)},a.encodeBinary=function(e,t){var r=s.QrSegment.makeBytes(e);return a.encodeSegments([r],t)},a.encodeSegments=function(e,t,r,n,u,o){if(r===void 0&&(r=1),n===void 0&&(n=40),u===void 0&&(u=-1),o===void 0&&(o=!0),!(a.MIN_VERSION<=r&&r<=n&&n<=a.MAX_VERSION)||u<-1||u>7)throw new RangeError("Invalid value");var l,w;for(l=r;;l++){var S=a.getNumDataCodewords(l,t)*8,C=p.getTotalBits(e,l);if(C<=S){w=C;break}if(l>=n)throw new RangeError("Data too long")}for(var b=0,k=[a.Ecc.MEDIUM,a.Ecc.QUARTILE,a.Ecc.HIGH];b<k.length;b++){var g=k[b];o&&w<=a.getNumDataCodewords(l,g)*8&&(t=g)}for(var E=[],_=0,z=e;_<z.length;_++){var M=z[_];f(M.mode.modeBits,4,E),f(M.numChars,M.mode.numCharCountBits(l),E);for(var B=0,O=M.getData();B<O.length;B++){var x=O[B];E.push(x)}}h(E.length==w);var d=a.getNumDataCodewords(l,t)*8;h(E.length<=d),f(0,Math.min(4,d-E.length),E),f(0,(8-E.length%8)%8,E),h(E.length%8==0);for(var A=236;E.length<d;A^=253)f(A,8,E);for(var Q=[];Q.length*8<E.length;)Q.push(0);return E.forEach(function(W,G){return Q[G>>>3]|=W<<7-(G&7)}),new a(l,t,Q,u)},a.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},a.prototype.getModules=function(){return this.modules},a.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var t=this.getAlignmentPatternPositions(),r=t.length,e=0;e<r;e++)for(var n=0;n<r;n++)e==0&&n==0||e==0&&n==r-1||e==r-1&&n==0||this.drawAlignmentPattern(t[e],t[n]);this.drawFormatBits(0),this.drawVersion()},a.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,r=t,n=0;n<10;n++)r=r<<1^(r>>>9)*1335;var u=(t<<10|r)^21522;h(u>>>15==0);for(var n=0;n<=5;n++)this.setFunctionModule(8,n,c(u,n));this.setFunctionModule(8,7,c(u,6)),this.setFunctionModule(8,8,c(u,7)),this.setFunctionModule(7,8,c(u,8));for(var n=9;n<15;n++)this.setFunctionModule(14-n,8,c(u,n));for(var n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,c(u,n));for(var n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,c(u,n));this.setFunctionModule(8,this.size-8,!0)},a.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^(e>>>11)*7973;var r=this.version<<12|e;h(r>>>18==0);for(var t=0;t<18;t++){var n=c(r,t),u=this.size-11+t%3,o=Math.floor(t/3);this.setFunctionModule(u,o,n),this.setFunctionModule(o,u,n)}}},a.prototype.drawFinderPattern=function(e,t){for(var r=-4;r<=4;r++)for(var n=-4;n<=4;n++){var u=Math.max(Math.abs(n),Math.abs(r)),o=e+n,l=t+r;0<=o&&o<this.size&&0<=l&&l<this.size&&this.setFunctionModule(o,l,u!=2&&u!=4)}},a.prototype.drawAlignmentPattern=function(e,t){for(var r=-2;r<=2;r++)for(var n=-2;n<=2;n++)this.setFunctionModule(e+n,t+r,Math.max(Math.abs(n),Math.abs(r))!=1)},a.prototype.setFunctionModule=function(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0},a.prototype.addEccAndInterleave=function(e){var t=this.version,r=this.errorCorrectionLevel;if(e.length!=a.getNumDataCodewords(t,r))throw new RangeError("Invalid argument");for(var n=a.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][t],u=a.ECC_CODEWORDS_PER_BLOCK[r.ordinal][t],o=Math.floor(a.getNumRawDataModules(t)/8),l=n-o%n,w=Math.floor(o/n),S=[],C=a.reedSolomonComputeDivisor(u),b=0,k=0;b<n;b++){var g=e.slice(k,k+w-u+(b<l?0:1));k+=g.length;var E=a.reedSolomonComputeRemainder(g,C);b<l&&g.push(0),S.push(g.concat(E))}for(var _=[],z=function(M){S.forEach(function(B,O){(M!=w-u||O>=l)&&_.push(B[M])})},b=0;b<S[0].length;b++)z(b);return h(_.length==o),_},a.prototype.drawCodewords=function(e){if(e.length!=Math.floor(a.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var t=0,r=this.size-1;r>=1;r-=2){r==6&&(r=5);for(var n=0;n<this.size;n++)for(var u=0;u<2;u++){var o=r-u,l=(r+1&2)==0,w=l?this.size-1-n:n;!this.isFunction[w][o]&&t<e.length*8&&(this.modules[w][o]=c(e[t>>>3],7-(t&7)),t++)}}h(t==e.length*8)},a.prototype.applyMask=function(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(var t=0;t<this.size;t++)for(var r=0;r<this.size;r++){var n=void 0;switch(e){case 0:n=(r+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=r%3==0;break;case 3:n=(r+t)%3==0;break;case 4:n=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:n=r*t%2+r*t%3==0;break;case 6:n=(r*t%2+r*t%3)%2==0;break;case 7:n=((r+t)%2+r*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][r]&&n&&(this.modules[t][r]=!this.modules[t][r])}},a.prototype.getPenaltyScore=function(){for(var e=0,t=0;t<this.size;t++){for(var r=!1,n=0,u=[0,0,0,0,0,0,0],o=0;o<this.size;o++)this.modules[t][o]==r?(n++,n==5?e+=a.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,u),r||(e+=this.finderPenaltyCountPatterns(u)*a.PENALTY_N3),r=this.modules[t][o],n=1);e+=this.finderPenaltyTerminateAndCount(r,n,u)*a.PENALTY_N3}for(var o=0;o<this.size;o++){for(var r=!1,l=0,u=[0,0,0,0,0,0,0],t=0;t<this.size;t++)this.modules[t][o]==r?(l++,l==5?e+=a.PENALTY_N1:l>5&&e++):(this.finderPenaltyAddHistory(l,u),r||(e+=this.finderPenaltyCountPatterns(u)*a.PENALTY_N3),r=this.modules[t][o],l=1);e+=this.finderPenaltyTerminateAndCount(r,l,u)*a.PENALTY_N3}for(var t=0;t<this.size-1;t++)for(var o=0;o<this.size-1;o++){var w=this.modules[t][o];w==this.modules[t][o+1]&&w==this.modules[t+1][o]&&w==this.modules[t+1][o+1]&&(e+=a.PENALTY_N2)}for(var S=0,C=0,b=this.modules;C<b.length;C++){var k=b[C];S=k.reduce(function(_,z){return _+(z?1:0)},S)}var g=this.size*this.size,E=Math.ceil(Math.abs(S*20-g*10)/g)-1;return h(0<=E&&E<=9),e+=E*a.PENALTY_N4,h(0<=e&&e<=2568888),e},a.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var e=Math.floor(this.version/7)+2,t=Math.floor((this.version*8+e*3+5)/(e*4-4))*2,r=[6],n=this.size-7;r.length<e;n-=t)r.splice(1,0,n);return r},a.getNumRawDataModules=function(e){if(e<a.MIN_VERSION||e>a.MAX_VERSION)throw new RangeError("Version number out of range");var t=(16*e+128)*e+64;if(e>=2){var r=Math.floor(e/7)+2;t-=(25*r-10)*r-55,e>=7&&(t-=36)}return h(208<=t&&t<=29648),t},a.getNumDataCodewords=function(e,t){return Math.floor(a.getNumRawDataModules(e)/8)-a.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e]*a.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e]},a.reedSolomonComputeDivisor=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");for(var t=[],r=0;r<e-1;r++)t.push(0);t.push(1);for(var n=1,r=0;r<e;r++){for(var u=0;u<t.length;u++)t[u]=a.reedSolomonMultiply(t[u],n),u+1<t.length&&(t[u]^=t[u+1]);n=a.reedSolomonMultiply(n,2)}return t},a.reedSolomonComputeRemainder=function(e,t){for(var r=t.map(function(w){return 0}),n=function(w){var S=w^r.shift();r.push(0),t.forEach(function(C,b){return r[b]^=a.reedSolomonMultiply(C,S)})},u=0,o=e;u<o.length;u++){var l=o[u];n(l)}return r},a.reedSolomonMultiply=function(e,t){if(e>>>8||t>>>8)throw new RangeError("Byte out of range");for(var r=0,n=7;n>=0;n--)r=r<<1^(r>>>7)*285,r^=(t>>>n&1)*e;return h(r>>>8==0),r},a.prototype.finderPenaltyCountPatterns=function(e){var t=e[1];h(t<=this.size*3);var r=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(r&&e[0]>=t*4&&e[6]>=t?1:0)+(r&&e[6]>=t*4&&e[0]>=t?1:0)},a.prototype.finderPenaltyTerminateAndCount=function(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)},a.prototype.finderPenaltyAddHistory=function(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)},a.MIN_VERSION=1,a.MAX_VERSION=40,a.PENALTY_N1=3,a.PENALTY_N2=3,a.PENALTY_N3=40,a.PENALTY_N4=10,a.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],a.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],a}();s.QrCode=i;function f(a,e,t){if(e<0||e>31||a>>>e)throw new RangeError("Value out of range");for(var r=e-1;r>=0;r--)t.push(a>>>r&1)}function c(a,e){return(a>>>e&1)!=0}function h(a){if(!a)throw new Error("Assertion error")}var p=function(){function a(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}return a.makeBytes=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var u=n[r];f(u,8,t)}return new a(a.Mode.BYTE,e.length,t)},a.makeNumeric=function(e){if(!a.isNumeric(e))throw new RangeError("String contains non-numeric characters");for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,3);f(parseInt(e.substring(r,r+n),10),n*3+1,t),r+=n}return new a(a.Mode.NUMERIC,e.length,t)},a.makeAlphanumeric=function(e){if(!a.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");var t=[],r;for(r=0;r+2<=e.length;r+=2){var n=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r))*45;n+=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r+1)),f(n,11,t)}return r<e.length&&f(a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r)),6,t),new a(a.Mode.ALPHANUMERIC,e.length,t)},a.makeSegments=function(e){return e==""?[]:a.isNumeric(e)?[a.makeNumeric(e)]:a.isAlphanumeric(e)?[a.makeAlphanumeric(e)]:[a.makeBytes(a.toUtf8ByteArray(e))]},a.makeEci=function(e){var t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)f(e,8,t);else if(e<16384)f(2,2,t),f(e,14,t);else if(e<1e6)f(6,3,t),f(e,21,t);else throw new RangeError("ECI assignment value out of range");return new a(a.Mode.ECI,0,t)},a.isNumeric=function(e){return a.NUMERIC_REGEX.test(e)},a.isAlphanumeric=function(e){return a.ALPHANUMERIC_REGEX.test(e)},a.prototype.getData=function(){return this.bitData.slice()},a.getTotalBits=function(e,t){for(var r=0,n=0,u=e;n<u.length;n++){var o=u[n],l=o.mode.numCharCountBits(t);if(o.numChars>=1<<l)return 1/0;r+=4+l+o.bitData.length}return r},a.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],r=0;r<e.length;r++)e.charAt(r)!="%"?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t},a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",a}();s.QrSegment=p})(U||(U={}));(function(s){(function(i){var f=function(){function c(h,p){this.ordinal=h,this.formatBits=p}return c.LOW=new c(0,1),c.MEDIUM=new c(1,0),c.QUARTILE=new c(2,3),c.HIGH=new c(3,2),c}();i.Ecc=f})(s.QrCode||(s.QrCode={}))})(U||(U={}));(function(s){(function(i){var f=function(){function c(h,p){this.modeBits=h,this.numBitsCharCount=p}return c.prototype.numCharCountBits=function(h){return this.numBitsCharCount[Math.floor((h+7)/17)]},c.NUMERIC=new c(1,[10,12,14]),c.ALPHANUMERIC=new c(2,[9,11,13]),c.BYTE=new c(4,[8,16,16]),c.KANJI=new c(8,[8,10,12]),c.ECI=new c(7,[0,0,0]),c}();i.Mode=f})(s.QrSegment||(s.QrSegment={}))})(U||(U={}));var H=U,X="L",J={L:H.QrCode.Ecc.LOW,M:H.QrCode.Ecc.MEDIUM,Q:H.QrCode.Ecc.QUARTILE,H:H.QrCode.Ecc.HIGH},Pe=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function Z(s){return s in J}function re(s,i){i===void 0&&(i=0);var f=[];return s.forEach(function(c,h){var p=null;c.forEach(function(a,e){if(!a&&p!==null){f.push("M".concat(p+i," ").concat(h+i,"h").concat(e-p,"v1H").concat(p+i,"z")),p=null;return}if(e===c.length-1){if(!a)return;p===null?f.push("M".concat(e+i,",").concat(h+i," h1v1H").concat(e+i,"z")):f.push("M".concat(p+i,",").concat(h+i," h").concat(e+1-p,"v1H").concat(p+i,"z"));return}a&&p===null&&(p=e)})}),f.join("")}function ae(s,i,f,c){var h=c.width,p=c.height,a=c.x,e=c.y,t=s.length+f*2,r=Math.floor(i*.1),n=t/i,u=(h||r)*n,o=(p||r)*n,l=a==null?s.length/2-u/2:a*n,w=e==null?s.length/2-o/2:e*n,S=null;if(c.excavate){var C=Math.floor(l),b=Math.floor(w),k=Math.ceil(u+l-C),g=Math.ceil(o+w-b);S={x:C,y:b,w:k,h:g}}return{x:l,y:w,h:o,w:u,excavation:S}}function ne(s,i){return s.slice().map(function(f,c){return c<i.y||c>=i.y+i.h?f:f.map(function(h,p){return p<i.x||p>=i.x+i.w?h:!1})})}var j={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:X,validator:function(s){return Z(s)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(s){return["linear","radial"].indexOf(s)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},be=D(D({},j),{renderAs:{type:String,required:!1,default:"canvas",validator:function(s){return["canvas","svg"].indexOf(s)>-1}}}),Se=$({name:"QRCodeSvg",props:j,setup:function(s){var i=K(0),f=K(""),c,h=function(){var a=s.value,e=s.level,t=s.margin,r=t>>>0,n=Z(e)?e:X,u=H.QrCode.encodeText(a,J[n]).getModules();if(i.value=u.length+r*2,s.imageSettings.src){var o=ae(u,s.size,r,s.imageSettings);c={x:o.x+r,y:o.y+r,width:o.w,height:o.h},o.excavation&&(u=ne(u,o.excavation))}f.value=re(u,r)},p=function(){if(!s.gradient)return null;var a=s.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return L(s.gradientType==="linear"?"linearGradient":"radialGradient",D({id:"qr-gradient"},a),[L("stop",{offset:"0%",style:{stopColor:s.gradientStartColor}}),L("stop",{offset:"100%",style:{stopColor:s.gradientEndColor}})])};return h(),te(h),function(){return L("svg",{width:s.size,height:s.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(i.value," ").concat(i.value)},[L("defs",{},[p()]),L("rect",{width:"100%",height:"100%",fill:s.background}),L("path",{fill:s.gradient?"url(#qr-gradient)":s.foreground,d:f.value}),s.imageSettings.src&&L("image",D({href:s.imageSettings.src},c))])}}}),ke=$({name:"QRCodeCanvas",props:j,setup:function(s,i){var f=K(null),c=K(null),h=function(){var a=s.value,e=s.level,t=s.size,r=s.margin,n=s.background,u=s.foreground,o=s.gradient,l=s.gradientType,w=s.gradientStartColor,S=s.gradientEndColor,C=r>>>0,b=Z(e)?e:X,k=f.value;if(k){var g=k.getContext("2d");if(g){var E=H.QrCode.encodeText(a,J[b]).getModules(),_=E.length+C*2,z=c.value,M={x:0,y:0,width:0,height:0},B=s.imageSettings.src&&z!=null&&z.naturalWidth!==0&&z.naturalHeight!==0;if(B){var O=ae(E,s.size,C,s.imageSettings);M={x:O.x+C,y:O.y+C,width:O.w,height:O.h},O.excavation&&(E=ne(E,O.excavation))}var x=window.devicePixelRatio||1,d=t/_*x;if(k.height=k.width=t*x,g.scale(d,d),g.fillStyle=n,g.fillRect(0,0,_,_),o){var A=void 0;l==="linear"?A=g.createLinearGradient(0,0,_,_):A=g.createRadialGradient(_/2,_/2,0,_/2,_/2,_/2),A.addColorStop(0,w),A.addColorStop(1,S),g.fillStyle=A}else g.fillStyle=u;Pe?g.fill(new Path2D(re(E,C))):E.forEach(function(Q,W){Q.forEach(function(G,oe){G&&g.fillRect(oe+C,W+C,1,1)})}),B&&g.drawImage(z,M.x,M.y,M.width,M.height)}}};ie(h),te(h);var p=i.attrs.style;return function(){return L(Y,[L("canvas",D(D({},i.attrs),{ref:f,style:D(D({},p),{width:"".concat(s.size,"px"),height:"".concat(s.size,"px")})})),s.imageSettings.src&&L("img",{ref:c,src:s.imageSettings.src,style:{display:"none"},onLoad:h})])}}}),Re=$({name:"Qrcode",render:function(){var s=this.$props,i=s.renderAs,f=s.value,c=s.size,h=s.margin,p=s.level,a=s.background,e=s.foreground,t=s.imageSettings,r=s.gradient,n=s.gradientType,u=s.gradientStartColor,o=s.gradientEndColor;return L(i==="svg"?Se:ke,{value:f,size:c,margin:h,level:p,background:a,foreground:e,imageSettings:t,gradient:r,gradientType:n,gradientStartColor:u,gradientEndColor:o})},props:be});const Ae={style:{width:"70%",margin:"20px auto"},class:"card"},Ie={style:{margin:"10px"}},Te={style:{"margin-top":"20px"}},ze={key:0},Oe={class:"button-wrapper"},Le={key:0,style:{"margin-top":"20px"}},Be={class:"ticket-content"},De={class:"ticket-header"},Fe={class:"ticket-title"},Ue={class:"ticket-code"},xe={class:"ticket-qrcode"},Qe={class:"ticket-info"},Ve={class:"info-item"},He={class:"value"},Ge={class:"info-item"},Ye={class:"value"},Ke={class:"info-item"},We={class:"value"},qe={class:"info-item"},$e={class:"value"},Xe={key:0,class:"ticket-actions"},Je={__name:"Orders",setup(s){const i=se({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),orderNo:null,cinemaName:null,status:null,pageNum:1,pageSize:5,total:0,tableData:[],ticketVisible:!1,currentTicket:{filmName:"",cinemaName:"",roomName:"",time:"",seatList:[],ticketCode:""},paymentPolling:{active:!1,orderNo:"",timer:null,attempts:0,maxAttempts:30}}),f=()=>{q.get("/orders/selectPage",{params:{pageNum:i.pageNum,pageSize:i.pageSize,orderNo:i.orderNo,cinemaName:i.cinemaName,status:i.status}}).then(o=>{o.code==="200"?(i.tableData=o.data.list,i.total=o.data.total):F.error(o.msg)})},c=()=>{i.orderNo=null,i.cinemaName=null,i.status=null,f()},h=o=>{q.get("/orders/cancel/"+o).then(l=>{l.code==="200"?(F.success("退票成功"),f()):F.error(l.msg)})},p=o=>{i.paymentPolling.orderNo=o.orderNo,i.paymentPolling.active=!0,i.paymentPolling.attempts=0,localStorage.setItem("polling_order",o.orderNo);const l=window.open(Ne.alipayUrl(o.orderNo),"_blank");a(o.orderNo);const w=setInterval(()=>{l&&l.closed&&(clearInterval(w),e(o.orderNo,!0))},1e3)},a=o=>{i.paymentPolling.timer&&clearInterval(i.paymentPolling.timer),i.paymentPolling.timer=setInterval(()=>{e(o)},1e4)},e=(o,l=!1)=>{if(!l&&i.paymentPolling.attempts>=i.paymentPolling.maxAttempts){t();return}i.paymentPolling.attempts++,Me.getOrderStatus(o).then(w=>{w.code==="200"&&(w.data==="待取票"?(t(),ge({title:"支付成功",message:"订单支付成功，您可以查看订单详情并取票",type:"success",duration:5e3}),f()):l&&(t(),F.info("如支付已完成，请手动刷新页面查看最新订单状态")))}).catch(()=>{l&&(t(),F.info("如支付已完成，请手动刷新页面查看最新订单状态"))})},t=()=>{i.paymentPolling.timer&&(clearInterval(i.paymentPolling.timer),i.paymentPolling.timer=null),i.paymentPolling.active=!1,localStorage.removeItem("polling_order")},r=o=>{i.currentTicket={...o,ticketCode:o.orderNo},i.ticketVisible=!0},n=()=>{q.get("/orders/pickup/"+i.currentTicket.id).then(o=>{o.code==="200"?(F.success("取票成功"),i.ticketVisible=!1,f()):F.error(o.msg)})},u=()=>{const o=localStorage.getItem("polling_order");o&&(i.paymentPolling.orderNo=o,i.paymentPolling.active=!0,i.paymentPolling.attempts=0,a(o),e(o))};return f(),u(),(o,l)=>{const w=ue,S=de,C=pe,b=ce,k=fe,g=we,E=_e,_=Ee,z=Ce,M=ye,B=he,O=ve,x=me;return R(),V(Y,null,[P("div",Ae,[v(w,{title:"沙箱测试支付账号信息",type:"info",closable:!1,style:{"margin-bottom":"20px"}},{default:m(()=>l[5]||(l[5]=[P("div",null,"买家账号：apvsnv2778@sandbox.com",-1),P("div",null,"登录密码：111111",-1),P("div",null,"支付密码：111111",-1)])),_:1}),P("div",Ie,[v(S,{modelValue:i.orderNo,"onUpdate:modelValue":l[0]||(l[0]=d=>i.orderNo=d),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入订单编号查询"},null,8,["modelValue"]),v(S,{modelValue:i.cinemaName,"onUpdate:modelValue":l[1]||(l[1]=d=>i.cinemaName=d),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入电影院名称查询"},null,8,["modelValue"]),v(b,{modelValue:i.status,"onUpdate:modelValue":l[2]||(l[2]=d=>i.status=d),placeholder:"请选择订单状态",style:{width:"240px","margin-right":"10px"}},{default:m(()=>[v(C,{label:"待取票",value:"待取票"}),v(C,{label:"已取票",value:"已取票"}),v(C,{label:"已退票",value:"已退票"}),v(C,{label:"待支付",value:"待支付"})]),_:1},8,["modelValue"]),v(k,{type:"info",plain:"",onClick:f},{default:m(()=>l[6]||(l[6]=[y("查询")])),_:1}),v(k,{type:"warning",plain:"",style:{margin:"0 10px"},onClick:c},{default:m(()=>l[7]||(l[7]=[y("重置")])),_:1})]),P("div",Te,[v(B,{"tooltip-effect":"dark",stripe:"",data:i.tableData},{default:m(()=>[v(M,{type:"expand"},{default:m(d=>[v(z,{class:"margin-top",title:"购票信息",column:4,border:""},{default:m(()=>[v(g,{label:"订单号"},{default:m(()=>[y(N(d.row.orderNo),1)]),_:2},1024),v(g,{label:"用户姓名"},{default:m(()=>[y(N(d.row.userName),1)]),_:2},1024),v(g,{label:"电影名称"},{default:m(()=>[y(N(d.row.filmName),1)]),_:2},1024),v(g,{label:"电影图片"},{default:m(()=>[d.row.filmImg?(R(),T(E,{key:0,style:{width:"40px",height:"40px",display:"block"},src:d.row.filmImg,"preview-src-list":[d.row.filmImg],"preview-teleported":""},null,8,["src","preview-src-list"])):I("",!0)]),_:2},1024),v(g,{label:"影院名称"},{default:m(()=>[y(N(d.row.cinemaName),1)]),_:2},1024),v(g,{label:"座位号"},{default:m(()=>[d.row.seatList&&d.row.seatList.length>0?(R(),V("div",ze,[(R(!0),V(Y,null,ee(d.row.seatList,A=>(R(),T(_,{type:"danger",style:{"margin-right":"5px"}},{default:m(()=>[y(N(A.row+"排"+A.col+"座"),1)]),_:2},1024))),256))])):I("",!0)]),_:2},1024),v(g,{label:"放映时间"},{default:m(()=>[y(N(d.row.time),1)]),_:2},1024),v(g,{label:"购票数量"},{default:m(()=>{var A;return[y(N((A=d.row.seatList)==null?void 0:A.length),1)]}),_:2},1024),v(g,{label:"订单金额"},{default:m(()=>[y(N(d.row.price),1)]),_:2},1024),v(g,{label:"下单时间"},{default:m(()=>[y(N(d.row.createTime),1)]),_:2},1024),v(g,{label:"订单状态"},{default:m(()=>[d.row.status==="待取票"?(R(),T(_,{key:0,type:"warning"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="已取票"?(R(),T(_,{key:1,type:"success"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="已退票"?(R(),T(_,{key:2,type:"danger"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="待支付"?(R(),T(_,{key:3,type:"primary"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024)]),_:1}),v(M,{prop:"orderNo",label:"订单号","show-overflow-tooltip":""}),v(M,{prop:"filmName",label:"电影名称","show-overflow-tooltip":""}),v(M,{prop:"filmImg",label:"电影封面",width:"90"},{default:m(d=>[d.row.filmImg?(R(),T(E,{key:0,style:{width:"40px",height:"40px","border-radius":"5px",display:"block"},src:d.row.filmImg,"preview-src-list":[d.row.filmImg],"preview-teleported":""},null,8,["src","preview-src-list"])):I("",!0)]),_:1}),v(M,{prop:"cinemaName",label:"影院名称","show-overflow-tooltip":""}),v(M,{prop:"roomName",label:"影厅名称"}),v(M,{prop:"time",label:"放映时间","show-overflow-tooltip":""}),v(M,{prop:"num",label:"购票数量"},{default:m(d=>{var A;return[y(N((A=d.row.seatList)==null?void 0:A.length),1)]}),_:1}),v(M,{prop:"price",label:"订单金额"},{default:m(d=>[y(N(d.row.price.toFixed(2)),1)]),_:1}),v(M,{prop:"status",label:"订单状态"},{default:m(d=>[d.row.status==="待取票"?(R(),T(_,{key:0,type:"warning"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="已取票"?(R(),T(_,{key:1,type:"success"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="已退票"?(R(),T(_,{key:2,type:"danger"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0),d.row.status==="待支付"?(R(),T(_,{key:3,type:"primary"},{default:m(()=>[y(N(d.row.status),1)]),_:2},1024)):I("",!0)]),_:1}),v(M,{label:"操作",width:"180",fixed:"right"},{default:m(d=>[P("div",Oe,[d.row.status==="待支付"?(R(),T(k,{key:0,type:"primary",onClick:A=>p(d.row)},{default:m(()=>l[8]||(l[8]=[y(" 支付 ")])),_:2},1032,["onClick"])):d.row.status==="待取票"?(R(),T(k,{key:1,type:"success",onClick:A=>r(d.row)},{default:m(()=>l[9]||(l[9]=[y(" 取票 ")])),_:2},1032,["onClick"])):I("",!0),d.row.status==="待取票"?(R(),T(k,{key:2,type:"danger",onClick:A=>h(d.row.id)},{default:m(()=>l[10]||(l[10]=[y(" 退票 ")])),_:2},1032,["onClick"])):I("",!0)])]),_:1})]),_:1},8,["data"])]),i.total?(R(),V("div",Le,[v(O,{onCurrentChange:f,background:"",layout:"total, prev, pager, next","page-size":i.pageSize,"current-page":i.pageNum,"onUpdate:currentPage":l[3]||(l[3]=d=>i.pageNum=d),total:i.total},null,8,["page-size","current-page","total"])])):I("",!0)]),v(x,{modelValue:i.ticketVisible,"onUpdate:modelValue":l[4]||(l[4]=d=>i.ticketVisible=d),title:"电影票",width:"400px","destroy-on-close":"",class:"ticket-dialog"},{default:m(()=>[P("div",Be,[P("div",De,[P("div",Fe,N(i.currentTicket.filmName),1),P("div",Ue,"取票码："+N(i.currentTicket.ticketCode),1)]),P("div",xe,[v(Re,{value:i.currentTicket.ticketCode,size:200,level:"H"},null,8,["value"])]),P("div",Qe,[P("div",Ve,[l[11]||(l[11]=P("span",{class:"label"},"影院：",-1)),P("span",He,N(i.currentTicket.cinemaName),1)]),P("div",Ge,[l[12]||(l[12]=P("span",{class:"label"},"影厅：",-1)),P("span",Ye,N(i.currentTicket.roomName),1)]),P("div",Ke,[l[13]||(l[13]=P("span",{class:"label"},"场次：",-1)),P("span",We,N(i.currentTicket.time),1)]),P("div",qe,[l[14]||(l[14]=P("span",{class:"label"},"座位：",-1)),P("span",$e,[(R(!0),V(Y,null,ee(i.currentTicket.seatList,d=>(R(),T(_,{key:d.id,type:"danger",style:{"margin-right":"5px"}},{default:m(()=>[y(N(d.row)+"排"+N(d.col)+"座 ",1)]),_:2},1024))),128))])])]),i.currentTicket.status==="待取票"?(R(),V("div",Xe,[v(k,{type:"primary",onClick:n},{default:m(()=>l[15]||(l[15]=[y("确认取票")])),_:1})])):I("",!0)])]),_:1},8,["modelValue"])],64)}}},mt=le(Je,[["__scopeId","data-v-7793dc25"]]);export{mt as default};
