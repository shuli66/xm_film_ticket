import{r as K,c as _,a as f,b as l,w as i,j as v,E as r,J as x,K as Q,L as R,M as G,N as H,O as W,o as p,h as c,i as b,u as y,P as X,Q as Y,F as Z,z as ee,R as te,S as le,I as oe,B as ae,T as ie,U as ne,l as re,m as se,V as de}from"./index-DNfxLx3V.js";/* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css            *//* empty css               *//* empty css                  *//* empty css               *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as u}from"./request-B9NmRS_H.js";/* empty css                    */const me={class:"card",style:{"margin-bottom":"5px"}},pe={class:"card",style:{"margin-bottom":"5px"}},ce={class:"card",style:{"margin-bottom":"5px"}},ue=["src"],fe={key:0,class:"card"},ge=["src"],_e={class:"dialog-footer"},Oe={__name:"Video",setup(be){const w="http://8.130.169.157",e=K({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:10,total:0,name:null,ids:[],filmData:[]}),k=()=>{u.get("/film/selectAll").then(a=>{a.code==="200"?e.filmData=a.data:r.error(a.msg)})},s=()=>{u.get("/video/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(a=>{var t,d;a.code==="200"&&(e.tableData=((t=a.data)==null?void 0:t.list)||[],e.total=(d=a.data)==null?void 0:d.total)})},C=()=>{e.form={},e.formVisible=!0},E=a=>{e.form=JSON.parse(JSON.stringify(a)),e.formVisible=!0},N=()=>{u.post("/video/add",e.form).then(a=>{a.code==="200"?(r.success("操作成功"),e.formVisible=!1,s()):r.error(a.msg)})},S=()=>{u.put("/video/update",e.form).then(a=>{a.code==="200"&&(r.success("操作成功"),e.formVisible=!1,s())})},I=()=>{e.form.id?S():N()},U=a=>{x.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(t=>{u.delete("/video/delete/"+a).then(d=>{d.code==="200"?(r.success("删除成功"),s()):r.error(d.msg)})}).catch(t=>{console.error(t)})},B=()=>{if(!e.ids.length){r.warning("请选择数据");return}x.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(a=>{u.delete("/video/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(r.success("操作成功"),s()):r.error(t.msg)})}).catch(a=>{console.error(a)})},z=a=>{e.ids=a.map(t=>t.id)},D=()=>{e.name=null,s()},F=a=>{e.form.img=a.data},P=a=>{e.form.video=a.data};return s(),k(),(a,t)=>{const d=Q,n=R,m=te,h=le,O=G,T=H,J=oe,M=ae,g=ie,V=ne,$=re("Plus"),A=se,L=de,j=W;return p(),_("div",null,[f("div",me,[l(d,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.name=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入电影名称查询"},null,8,["modelValue"]),l(n,{type:"info",plain:"",onClick:s},{default:i(()=>t[6]||(t[6]=[c("查询")])),_:1}),l(n,{type:"warning",plain:"",style:{margin:"0 10px"},onClick:D},{default:i(()=>t[7]||(t[7]=[c("重置")])),_:1})]),f("div",pe,[l(n,{type:"primary",plain:"",onClick:C},{default:i(()=>t[8]||(t[8]=[c("新增")])),_:1}),l(n,{type:"danger",plain:"",onClick:B},{default:i(()=>t[9]||(t[9]=[c("批量删除")])),_:1})]),f("div",ce,[l(O,{stripe:"",data:e.tableData,onSelectionChange:z},{default:i(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"filmName",label:"电影名称"}),l(m,{prop:"filmImg",label:"电影封面"},{default:i(o=>[o.row.filmImg?(p(),b(h,{key:0,style:{width:"40px",height:"40px","border-radius":"5px",display:"block"},src:o.row.filmImg,"preview-src-list":[o.row.filmImg],"preview-teleported":""},null,8,["src","preview-src-list"])):v("",!0)]),_:1}),l(m,{prop:"name",label:"视频名称"}),l(m,{prop:"img",label:"视频封面"},{default:i(o=>[o.row.img?(p(),b(h,{key:0,style:{width:"40px",height:"40px","border-radius":"5px",display:"block"},src:o.row.img,"preview-src-list":[o.row.img],"preview-teleported":""},null,8,["src","preview-src-list"])):v("",!0)]),_:1}),l(m,{prop:"video",label:"预告视频",width:"300"},{default:i(o=>[f("video",{src:o.row.video,controls:"",style:{width:"100%"}},null,8,ue)]),_:1}),l(m,{prop:"time",label:"发布时间"}),l(m,{label:"操作",width:"100",fixed:"right"},{default:i(o=>[l(n,{type:"primary",circle:"",icon:y(X),onClick:q=>E(o.row)},null,8,["icon","onClick"]),l(n,{type:"danger",circle:"",icon:y(Y),onClick:q=>U(o.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(p(),_("div",fe,[l(T,{onCurrentChange:s,background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):v("",!0),l(j,{title:"预告视频信息",modelValue:e.formVisible,"onUpdate:modelValue":t[5]||(t[5]=o=>e.formVisible=o),width:"40%","destroy-on-close":""},{footer:i(()=>[f("span",_e,[l(n,{onClick:t[4]||(t[4]=o=>e.formVisible=!1)},{default:i(()=>t[11]||(t[11]=[c("取 消")])),_:1}),l(n,{type:"primary",onClick:I},{default:i(()=>t[12]||(t[12]=[c("确 定")])),_:1})])]),default:i(()=>[l(L,{ref:"form",model:e.form,"label-width":"70px",style:{padding:"20px"}},{default:i(()=>[l(g,{prop:"filmId",label:"选择电影"},{default:i(()=>[l(M,{modelValue:e.form.filmId,"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.filmId=o),placeholder:"请选择电影"},{default:i(()=>[(p(!0),_(Z,null,ee(e.filmData,o=>(p(),b(J,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(g,{prop:"name",label:"视频名称"},{default:i(()=>[l(d,{modelValue:e.form.name,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.name=o),placeholder:"请输入视频名称"},null,8,["modelValue"])]),_:1}),l(g,{prop:"img",label:"视频封面"},{default:i(()=>[l(V,{action:y(w)+"/files/upload","on-success":F,"list-type":"picture"},{default:i(()=>[l(n,{type:"primary"},{default:i(()=>t[10]||(t[10]=[c("点击上传")])),_:1})]),_:1},8,["action"])]),_:1}),l(g,{prop:"video",label:"视频文件"},{default:i(()=>[l(V,{class:"avatar-uploader",action:y(w)+"/files/upload","filmShow-file-list":!1,"on-success":P},{default:i(()=>[e.form.video?(p(),_("video",{key:0,src:e.form.video,controls:"",style:{width:"350px",height:"200px"}},null,8,ge)):(p(),b(A,{key:1,class:"avatar-uploader-icon"},{default:i(()=>[l($)]),_:1}))]),_:1},8,["action"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{Oe as default};
