import{v as N,r as I,c as n,a as V,b as t,w as a,V as F,o as r,u as b,i as u,h as c,t as y,j as k,E as h,l as T,m as J,U as O,T as P,K as R,G as j,L as D}from"./index-DNfxLx3V.js";/* empty css                  *//* empty css               *//* empty css            *//* empty css              *//* empty css                 */import{r as G}from"./request-B9NmRS_H.js";const K={style:{width:"50%"},class:"card"},L=["src"],M=["src"],z=["src"],A={style:{"text-align":"center"}},te={__name:"Certificate",emits:["updateUser"],setup(H,{emit:x}){const i="http://8.130.169.157",v=N(),e=I({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),rules:{front:[{required:!0,message:"请上传身份证正面",trigger:"blur"}],back:[{required:!0,message:"请上传身份证反面",trigger:"blur"}],certificate:[{required:!0,message:"请上传营业执照",trigger:"blur"}],leader:[{required:!0,message:"请填写负责人姓名",trigger:"blur"}],code:[{required:!0,message:"请填写负责人身份证号",trigger:"blur"}],address:[{required:!0,message:"请填写影院地址",trigger:"blur"}]}}),U=l=>{e.user.front=l.data},E=l=>{e.user.back=l.data},w=l=>{e.user.certificate=l.data},S=x,q=()=>{v.value.validate(l=>{l&&(e.user.status="待审核",G.put("/cinema/update",e.user).then(s=>{s.code==="200"?(h.success("提交成功"),localStorage.setItem("xm-user",JSON.stringify(e.user)),S("updateUser")):h.error(s.msg)}))})};return(l,s)=>{const p=T("Plus"),m=J,f=O,o=P,_=R,g=j,B=D,C=F;return r(),n("div",K,[s[4]||(s[4]=V("div",{style:{color:"red",padding:"10px"}}," 一旦认证信息修改，影院状态就会变为待审核状态，将无法使用影院功能 ",-1)),t(C,{ref_key:"formRef",ref:v,rules:e.rules,model:e.user,"label-width":"95px",style:{padding:"20px"}},{default:a(()=>[t(o,{prop:"front",label:"身份证正面"},{default:a(()=>[t(f,{action:b(i)+"/files/upload","on-success":U,"filmShow-file-list":!1,class:"avatar-uploader"},{default:a(()=>[e.user.front?(r(),n("img",{key:0,src:e.user.front,class:"avatar"},null,8,L)):(r(),u(m,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[t(p)]),_:1}))]),_:1},8,["action"])]),_:1}),t(o,{prop:"back",label:"身份证反面"},{default:a(()=>[t(f,{action:b(i)+"/files/upload","on-success":E,"filmShow-file-list":!1,class:"avatar-uploader"},{default:a(()=>[e.user.back?(r(),n("img",{key:0,src:e.user.back,class:"avatar"},null,8,M)):(r(),u(m,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[t(p)]),_:1}))]),_:1},8,["action"])]),_:1}),t(o,{prop:"certificate",label:"营业执照"},{default:a(()=>[t(f,{action:b(i)+"/files/upload","on-success":w,"filmShow-file-list":!1,class:"avatar-uploader"},{default:a(()=>[e.user.certificate?(r(),n("img",{key:0,src:e.user.certificate,class:"avatar"},null,8,z)):(r(),u(m,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[t(p)]),_:1}))]),_:1},8,["action"])]),_:1}),t(o,{prop:"leader",label:"负责人姓名"},{default:a(()=>[t(_,{modelValue:e.user.leader,"onUpdate:modelValue":s[0]||(s[0]=d=>e.user.leader=d),placeholder:"请输入负责人姓名"},null,8,["modelValue"])]),_:1}),t(o,{prop:"code",label:"身份证号"},{default:a(()=>[t(_,{modelValue:e.user.code,"onUpdate:modelValue":s[1]||(s[1]=d=>e.user.code=d),placeholder:"请输入身份证号"},null,8,["modelValue"])]),_:1}),t(o,{prop:"address",label:"影院地址"},{default:a(()=>[t(_,{type:"textarea",rows:4,modelValue:e.user.address,"onUpdate:modelValue":s[2]||(s[2]=d=>e.user.address=d),placeholder:"请输入影院地址"},null,8,["modelValue"])]),_:1}),t(o,{prop:"status",label:"审核状态"},{default:a(()=>[e.user.status==="待审核"?(r(),u(g,{key:0,type:"warning"},{default:a(()=>[c(y(e.user.status),1)]),_:1})):k("",!0),e.user.status==="审核通过"?(r(),u(g,{key:1,type:"success"},{default:a(()=>[c(y(e.user.status),1)]),_:1})):k("",!0),e.user.status==="审核拒绝"?(r(),u(g,{key:2,type:"danger"},{default:a(()=>[c(y(e.user.status),1)]),_:1})):k("",!0)]),_:1}),V("div",A,[t(B,{type:"primary",onClick:q},{default:a(()=>s[3]||(s[3]=[c("提 交")])),_:1})])]),_:1},8,["rules","model"])])}}};export{te as default};
