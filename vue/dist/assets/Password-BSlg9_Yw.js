import{v as c,r as _,c as g,b as s,w as a,V as P,o as V,a as x,h as E,E as n,d as v,K as b,T as h,L as y}from"./index-DNfxLx3V.js";/* empty css                  *//* empty css               *//* empty css              */import{r as S}from"./request-B9NmRS_H.js";const B={style:{width:"50%"},class:"card"},I={style:{"text-align":"center"}},R={__name:"Password",setup(N){const u=c(),m=(l,e,o)=>{e?(e!==r.user.newPassword&&o(new Error("确认密码跟原密码不一致!")),o()):o(new Error("请确认密码"))},r=_({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{validator:m,trigger:"blur"}]}}),p=()=>{u.value.validate(l=>{l&&S.put("/updatePassword",r.user).then(e=>{e.code==="200"?(n.success("保存成功"),i()):n.error(e.msg)})})},i=()=>{localStorage.removeItem("xm-user"),v.push("/login")};return(l,e)=>{const o=b,d=h,w=y,f=P;return V(),g("div",B,[s(f,{ref_key:"formRef",ref:u,rules:r.rules,model:r.user,"label-width":"80px",style:{padding:"20px"}},{default:a(()=>[s(d,{label:"原密码",prop:"password"},{default:a(()=>[s(o,{modelValue:r.user.password,"onUpdate:modelValue":e[0]||(e[0]=t=>r.user.password=t),placeholder:"请输入原密码","filmShow-password":""},null,8,["modelValue"])]),_:1}),s(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[s(o,{modelValue:r.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=t=>r.user.newPassword=t),placeholder:"请输入新密码","filmShow-password":""},null,8,["modelValue"])]),_:1}),s(d,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[s(o,{modelValue:r.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>r.user.confirmPassword=t),placeholder:"请确认新密码","filmShow-password":""},null,8,["modelValue"])]),_:1}),x("div",I,[s(w,{type:"primary",onClick:p},{default:a(()=>e[3]||(e[3]=[E("保 存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{R as default};
