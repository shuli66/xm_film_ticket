import{_ as Q,v as W,r as X,c as h,a as n,b as o,w as l,u as m,W as Z,i as S,j as y,E as c,J as z,L as ee,X as te,Y as oe,M as le,N as ae,O as ie,Z as ne,o as f,$ as se,a0 as re,h as s,a1 as de,a2 as ce,Q as B,a3 as me,t as g,a4 as pe,P as ue,a5 as fe,a6 as ge,K as _e,a7 as ve,R as be,G as we,m as he,a8 as ye,T as Ve,a9 as ke,aa as xe,V as Ce}from"./index-DNfxLx3V.js";/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                    *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css               *//* empty css              *//* empty css                     *//* empty css                 *//* empty css                *//* empty css            *//* empty css               *//* empty css              */import{r as _}from"./request-B9NmRS_H.js";/* empty css                    */const Ee={class:"notice-manager-container"},Ne={class:"card search-card"},Se={class:"card-body"},ze={class:"card action-card"},Be={class:"card-body"},Te={class:"card table-card"},De={class:"card-body"},Fe={class:"time-display"},Le={class:"action-buttons"},Ue={key:0,class:"empty-block"},$e={key:0,class:"card pagination-card"},Re={class:"card-body"},qe={class:"dialog-footer"},Je={class:"notice-view-container"},Me={class:"notice-view-header"},Oe={class:"notice-view-title"},Ye={class:"notice-view-meta"},Ie={class:"notice-view-time"},Pe={class:"notice-view-content"},je={__name:"Notice",setup(Ke){const b=W(null),e=X({formVisible:!1,viewVisible:!1,form:{},viewForm:{},tableData:[],pageNum:1,pageSize:10,total:0,title:null,ids:[],loading:!1,saveLoading:!1,rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"},{min:2,max:50,message:"标题长度在 2 到 50 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"},{min:5,max:500,message:"内容长度在 5 到 500 个字符",trigger:"blur"}]}}),V=a=>a?ge(a).format("YYYY-MM-DD HH:mm:ss"):"",r=()=>{e.loading=!0,_.get("/notice/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title||void 0}}).then(a=>{var t,p;a.code==="200"?(e.tableData=((t=a.data)==null?void 0:t.list)||[],e.total=((p=a.data)==null?void 0:p.total)||0):c.error(a.msg||"获取数据失败")}).finally(()=>{e.loading=!1})},T=a=>{e.pageSize=a,e.pageNum=1,r()},D=()=>{e.form={important:!1},e.formVisible=!0},F=a=>{e.form=JSON.parse(JSON.stringify(a)),e.form.important=!!e.form.important,e.formVisible=!0},L=a=>{e.viewForm=JSON.parse(JSON.stringify(a)),e.viewForm.important=!!e.viewForm.important,e.viewVisible=!0},U=()=>{e.saveLoading=!0,e.form.time=new Date,_.post("/notice/add",e.form).then(a=>{a.code==="200"?(c.success("新增公告成功"),e.formVisible=!1,r()):c.error(a.msg||"操作失败")}).finally(()=>{e.saveLoading=!1})},$=()=>{e.saveLoading=!0,_.put("/notice/update",e.form).then(a=>{a.code==="200"?(c.success("更新公告成功"),e.formVisible=!1,r()):c.error(a.msg||"操作失败")}).finally(()=>{e.saveLoading=!1})},R=()=>{b.value&&b.value.validate(a=>{if(a)e.form.id?$():U();else return!1})},q=a=>{z.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",draggable:!0}).then(()=>{_.delete("/notice/delete/"+a).then(t=>{t.code==="200"?(c.success("删除成功"),r()):c.error(t.msg||"删除失败")})}).catch(()=>{})},J=()=>{if(!e.ids.length){c.warning("请至少选择一条数据");return}z.confirm(`确定要删除选中的 ${e.ids.length} 条数据吗？删除后不可恢复！`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",draggable:!0}).then(()=>{_.delete("/notice/delete/batch",{data:e.ids}).then(a=>{a.code==="200"?(c.success(`成功删除 ${e.ids.length} 条数据`),e.ids=[],r()):c.error(a.msg||"批量删除失败")})}).catch(()=>{})},M=a=>{e.ids=a.map(t=>t.id)},O=()=>{e.title=null,e.pageNum=1,r()};return r(),(a,t)=>{const p=_e,k=ve,d=ee,Y=te,v=oe,u=be,x=we,I=he,P=le,j=ye,K=ae,w=Ve,C=ke,G=xe,H=Ce,E=ie,A=ne;return f(),h("div",Ee,[t[19]||(t[19]=n("div",{class:"notice-manager-header"},[n("div",{class:"notice-manager-title"},"公告管理"),n("div",{class:"notice-manager-subtitle"},"管理系统公告信息")],-1)),n("div",Ne,[n("div",Se,[o(Y,{gutter:20},{default:l(()=>[o(k,{span:6},{default:l(()=>[o(p,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=i=>e.title=i),placeholder:"请输入公告标题查询",clearable:"","prefix-icon":"Search",onKeyup:se(r,["enter"])},null,8,["modelValue"])]),_:1}),o(k,{span:12},{default:l(()=>[o(d,{type:"primary",onClick:r,icon:m(re)},{default:l(()=>t[9]||(t[9]=[s("查询")])),_:1},8,["icon"]),o(d,{onClick:O,icon:m(de)},{default:l(()=>t[10]||(t[10]=[s("重置")])),_:1},8,["icon"])]),_:1})]),_:1})])]),n("div",ze,[n("div",Be,[o(d,{type:"primary",icon:m(ce),onClick:D},{default:l(()=>t[11]||(t[11]=[s("新增公告")])),_:1},8,["icon"]),o(d,{type:"danger",icon:m(B),onClick:J,disabled:!e.ids.length},{default:l(()=>t[12]||(t[12]=[s("批量删除")])),_:1},8,["icon","disabled"]),o(v,{content:"刷新数据",placement:"top"},{default:l(()=>[o(d,{icon:m(me),circle:"",onClick:r},null,8,["icon"])]),_:1})])]),n("div",Te,[n("div",De,[Z((f(),S(P,{border:"",stripe:"",data:e.tableData,onSelectionChange:M,style:{width:"100%"},"header-cell-style":{background:"#f8f9fa",color:"#606266"},"highlight-current-row":""},{default:l(()=>[o(u,{type:"selection",width:"55",align:"center"}),o(u,{type:"index",label:"#",width:"60",align:"center"}),o(u,{prop:"title",label:"公告标题","min-width":"150","show-overflow-tooltip":""},{default:l(i=>[o(x,{effect:"plain",type:"info",size:"small",style:{"margin-right":"5px"}},{default:l(()=>t[13]||(t[13]=[s("公告")])),_:1}),s(" "+g(i.row.title),1)]),_:1}),o(u,{prop:"content",label:"公告内容","min-width":"250","show-overflow-tooltip":""}),o(u,{prop:"time",label:"发布时间","min-width":"180",align:"center"},{default:l(i=>[n("div",Fe,[o(I,null,{default:l(()=>[o(m(pe))]),_:1}),s(" "+g(V(i.row.time)),1)])]),_:1}),o(u,{label:"操作",width:"160",fixed:"right",align:"center"},{default:l(i=>[n("div",Le,[o(v,{content:"编辑",placement:"top"},{default:l(()=>[o(d,{type:"primary",icon:m(ue),circle:"",onClick:N=>F(i.row)},null,8,["icon","onClick"])]),_:2},1024),o(v,{content:"查看",placement:"top"},{default:l(()=>[o(d,{type:"success",icon:m(fe),circle:"",onClick:N=>L(i.row)},null,8,["icon","onClick"])]),_:2},1024),o(v,{content:"删除",placement:"top"},{default:l(()=>[o(d,{type:"danger",icon:m(B),circle:"",onClick:N=>q(i.row.id)},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data"])),[[A,e.loading]]),!e.tableData.length&&!e.loading?(f(),h("div",Ue,[o(j,{description:"暂无公告数据"})])):y("",!0)])]),e.total?(f(),h("div",$e,[n("div",Re,[o(K,{"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=i=>e.pageNum=i),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=i=>e.pageSize=i),"page-sizes":[10,20,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:e.total,onSizeChange:T,onCurrentChange:r},null,8,["current-page","page-size","total"])])])):y("",!0),o(E,{modelValue:e.formVisible,"onUpdate:modelValue":t[7]||(t[7]=i=>e.formVisible=i),title:e.form.id?"编辑公告":"新增公告",width:"600px","destroy-on-close":"","close-on-click-modal":!1},{footer:l(()=>[n("div",qe,[o(d,{onClick:t[6]||(t[6]=i=>e.formVisible=!1)},{default:l(()=>t[16]||(t[16]=[s("取 消")])),_:1}),o(d,{type:"primary",onClick:R,loading:e.saveLoading},{default:l(()=>t[17]||(t[17]=[s("保 存")])),_:1},8,["loading"])])]),default:l(()=>[o(H,{ref_key:"formRef",ref:b,model:e.form,rules:e.rules,"label-width":"100px","label-position":"right","status-icon":""},{default:l(()=>[o(w,{prop:"title",label:"公告标题",required:""},{default:l(()=>[o(p,{modelValue:e.form.title,"onUpdate:modelValue":t[3]||(t[3]=i=>e.form.title=i),placeholder:"请输入公告标题",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(w,{prop:"content",label:"公告内容",required:""},{default:l(()=>[o(p,{type:"textarea",rows:6,modelValue:e.form.content,"onUpdate:modelValue":t[4]||(t[4]=i=>e.form.content=i),placeholder:"请输入公告内容",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(w,{prop:"important",label:"重要程度"},{default:l(()=>[o(G,{modelValue:e.form.important,"onUpdate:modelValue":t[5]||(t[5]=i=>e.form.important=i)},{default:l(()=>[o(C,{label:!0},{default:l(()=>t[14]||(t[14]=[s("重要")])),_:1}),o(C,{label:!1},{default:l(()=>t[15]||(t[15]=[s("普通")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),o(E,{modelValue:e.viewVisible,"onUpdate:modelValue":t[8]||(t[8]=i=>e.viewVisible=i),title:"公告详情",width:"600px","destroy-on-close":""},{default:l(()=>[n("div",Je,[n("div",Me,[n("h2",Oe,g(e.viewForm.title),1),n("div",Ye,[e.viewForm.important?(f(),S(x,{key:0,type:"danger",size:"small",effect:"dark"},{default:l(()=>t[18]||(t[18]=[s("重要")])),_:1})):y("",!0),n("span",Ie,g(V(e.viewForm.time)),1)])]),n("div",Pe,g(e.viewForm.content),1)])]),_:1},8,["modelValue"])])}}},ut=Q(je,[["__scopeId","data-v-12d05ac0"]]);export{ut as default};
