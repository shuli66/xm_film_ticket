import{r as B,c as f,a as u,b as l,w as r,j as S,E as a,J as g,K as z,L as D,M as U,N as $,O as M,o as _,h as p,u as x,Q as P,P as F,R as j,T as q,V as A}from"./index-CwlnEuFy.js";/* empty css               *//* empty css                *//* empty css                  *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css               *//* empty css                     *//* empty css                 *//* empty css                *//* empty css               *//* empty css              */import{r as c}from"./request--KQcSzqU.js";/* empty css                    */const J={class:"card",style:{"margin-bottom":"5px"}},K={class:"card",style:{"margin-bottom":"5px"}},L={class:"card",style:{"margin-bottom":"5px"}},O={key:0,class:"card"},Q={class:"dialog-footer"},de={__name:"Comment",setup(R){const e=B({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,filmId:null,commentText:"",ids:[]}),m=()=>{c.get("/comment/selectComments",{params:{pageNum:e.pageNum,pageSize:e.pageSize,filmId:e.filmId,commentText:e.commentText}}).then(o=>{var t,s;o.code==="200"?(e.tableData=((t=o.data)==null?void 0:t.list)||[],e.total=(s=o.data)==null?void 0:s.total):a.error(o.msg)}).catch(o=>{console.error(o),a.error("加载数据失败")})},b=o=>{g.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(()=>{c.delete(`/comment/deleteCommentByAdmin/${o}`).then(t=>{t.code==="200"?(a.success("删除成功"),m()):a.error(t.msg)}).catch(t=>{console.error(t),a.error("删除失败")})}).catch(t=>{console.error(t)})},V=()=>{if(!e.ids.length){a.warning("请选择数据");return}g.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(()=>{c.delete("/comment/deleteBatchComment",{data:e.ids}).then(o=>{o.code==="200"?(a.success("操作成功"),m()):a.error(o.msg)}).catch(o=>{console.error(o),a.error("批量删除失败")})}).catch(o=>{console.error(o)})},y=o=>{e.ids=o.map(t=>t.id)},h=()=>{e.filmId=null,e.commentText="",m()},C=o=>{e.form={...o},e.formVisible=!0},w=()=>{e.form.id?c.put("/comment/updateComment",e.form).then(o=>{o.code==="200"?(a.success("评论更新成功"),e.formVisible=!1,m()):a.error(o.msg)}).catch(o=>{console.error(o),a.error("更新评论失败")}):c.post("/comment/addComment",e.form).then(o=>{o.code==="200"?(a.success("评论添加成功"),e.formVisible=!1,m()):a.error(o.msg)}).catch(o=>{console.error(o),a.error("添加评论失败")})};return m(),(o,t)=>{const s=z,i=D,d=j,T=U,k=$,E=q,v=A,I=M;return _(),f("div",null,[u("div",J,[l(s,{modelValue:e.filmId,"onUpdate:modelValue":t[0]||(t[0]=n=>e.filmId=n),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入电影ID查询"},null,8,["modelValue"]),l(s,{modelValue:e.commentText,"onUpdate:modelValue":t[1]||(t[1]=n=>e.commentText=n),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入评论内容查询"},null,8,["modelValue"]),l(i,{type:"info",plain:"",onClick:m},{default:r(()=>t[6]||(t[6]=[p("查询")])),_:1}),l(i,{type:"warning",plain:"",style:{margin:"0 10px"},onClick:h},{default:r(()=>t[7]||(t[7]=[p("重置")])),_:1})]),u("div",K,[l(i,{type:"danger",plain:"",onClick:V},{default:r(()=>t[8]||(t[8]=[p("批量删除")])),_:1})]),u("div",L,[l(T,{stripe:"",data:e.tableData,onSelectionChange:y},{default:r(()=>[l(d,{type:"selection",width:"55"}),l(d,{prop:"userName",label:"用户姓名"}),l(d,{prop:"filmId",label:"电影ID"}),l(d,{prop:"commentText",label:"评论内容"}),l(d,{prop:"createTime",label:"评论时间"}),l(d,{label:"操作",width:"150",fixed:"right"},{default:r(n=>[l(i,{type:"danger",circle:"",icon:x(P),onClick:N=>b(n.row.id)},null,8,["icon","onClick"]),l(i,{type:"primary",circle:"",icon:x(F),onClick:N=>C(n.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(_(),f("div",O,[l(k,{onCurrentChange:m,background:"",layout:"prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[2]||(t[2]=n=>e.pageNum=n),total:e.total},null,8,["page-size","current-page","total"])])):S("",!0),l(I,{title:"修改评论",modelValue:e.formVisible,"onUpdate:modelValue":t[5]||(t[5]=n=>e.formVisible=n),width:"40%","destroy-on-close":""},{footer:r(()=>[u("span",Q,[l(i,{onClick:t[4]||(t[4]=n=>e.formVisible=!1)},{default:r(()=>t[9]||(t[9]=[p("取 消")])),_:1}),l(i,{type:"primary",onClick:w},{default:r(()=>t[10]||(t[10]=[p("确 定")])),_:1})])]),default:r(()=>[l(v,{ref:"form",model:e.form,"label-width":"70px",style:{padding:"20px"}},{default:r(()=>[l(E,{prop:"commentText",label:"评论内容"},{default:r(()=>[l(s,{modelValue:e.form.commentText,"onUpdate:modelValue":t[3]||(t[3]=n=>e.form.commentText=n),type:"textarea",rows:"4",placeholder:"请输入评论内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{de as default};
