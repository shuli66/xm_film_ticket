import{v as c,r as g,c as x,a as n,b as r,w as a,V as P,o as V,h as v,E as p,d as E,K as b,T as y,L as h}from"./index-DNfxLx3V.js";/* empty css                  *//* empty css               *//* empty css              */import{r as B}from"./request-B9NmRS_H.js";const I={style:{width:"40%",margin:"20px auto"},class:"card"},N={style:{"text-align":"center"}},R={__name:"Password",setup(q){const u=c(),m=(l,e,o)=>{e?(e!==s.user.newPassword&&o(new Error("确认密码跟原密码不一致!")),o()):o(new Error("请确认密码"))},s=g({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{validator:m,trigger:"blur"}]}}),i=()=>{u.value.validate(l=>{l&&B.put("/updatePassword",s.user).then(e=>{e.code==="200"?(p.success("保存成功"),w()):p.error(e.msg)})})},w=()=>{localStorage.removeItem("xm-user"),E.push("/login")};return(l,e)=>{const o=b,d=y,f=h,_=P;return V(),x("div",I,[e[4]||(e[4]=n("div",{style:{"font-size":"20px",padding:"20px 20px"}},"修改密码",-1)),r(_,{ref_key:"formRef",ref:u,rules:s.rules,model:s.user,"label-width":"80px",style:{padding:"20px"}},{default:a(()=>[r(d,{label:"原密码",prop:"password"},{default:a(()=>[r(o,{modelValue:s.user.password,"onUpdate:modelValue":e[0]||(e[0]=t=>s.user.password=t),placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[r(o,{modelValue:s.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=t=>s.user.newPassword=t),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[r(o,{modelValue:s.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.user.confirmPassword=t),placeholder:"请确认新密码","show-password":""},null,8,["modelValue"])]),_:1}),n("div",N,[r(f,{type:"primary",onClick:i},{default:a(()=>e[3]||(e[3]=[v("保 存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{R as default};
